<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>frida小总结（1） | jjkk逆之作坊</title><meta name="author" content="jjkk"><meta name="copyright" content="jjkk"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="终于要更新博客了，有点幽默了…… 最近碰到了一个神奇的题目，记录一下感想 首先，我本来都是习惯用jeb分析apk的，但是后来听不记得哪位师傅说，其实jadx反编译更贴近源代码，而且我发现，原来jadx也是可以完成apk java层动态调试工作的，所以成功转手 我们可以看一下大致的代码逻辑 1234567891011121314151617181920212223242526272829303132">
<meta property="og:type" content="article">
<meta property="og:title" content="frida小总结（1）">
<meta property="og:url" content="http://example.com/2024/12/01/frida1/index.html">
<meta property="og:site_name" content="jjkk逆之作坊">
<meta property="og:description" content="终于要更新博客了，有点幽默了…… 最近碰到了一个神奇的题目，记录一下感想 首先，我本来都是习惯用jeb分析apk的，但是后来听不记得哪位师傅说，其实jadx反编译更贴近源代码，而且我发现，原来jadx也是可以完成apk java层动态调试工作的，所以成功转手 我们可以看一下大致的代码逻辑 1234567891011121314151617181920212223242526272829303132">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/img/jjkk.jpg">
<meta property="article:published_time" content="2024-12-01T12:05:35.000Z">
<meta property="article:modified_time" content="2024-12-02T13:21:28.634Z">
<meta property="article:author" content="jjkk">
<meta property="article:tag" content="frida">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/jjkk.jpg"><link rel="shortcut icon" href="/img/sevedy.jpg"><link rel="canonical" href="http://example.com/2024/12/01/frida1/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'frida小总结（1）',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  isShuoshuo: false
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/jjkk.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">2</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">1</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archives"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/catrgories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 列表</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/KK.gif);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">jjkk逆之作坊</span></a><a class="nav-page-title" href="/"><span class="site-name">frida小总结（1）</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archives"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/catrgories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 列表</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">frida小总结（1）</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2024-12-01T12:05:35.000Z" title="Created 2024-12-01 20:05:35">2024-12-01</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2024-12-02T13:21:28.634Z" title="Updated 2024-12-02 21:21:28">2024-12-02</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><p>终于要更新博客了，有点幽默了……</p>
<p>最近碰到了一个神奇的题目，记录一下感想</p>
<p>首先，我本来都是习惯用jeb分析apk的，但是后来听不记得哪位师傅说，其实jadx反编译更贴近源代码，而且我发现，原来jadx也是可以完成apk java层动态调试工作的，所以成功转手</p>
<p>我们可以看一下大致的代码逻辑</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Mainactivity</span></span><br><span class="line"><span class="keyword">package</span> com.example.WarmUp;</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.util.Base64;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.widget.Button;</span><br><span class="line"><span class="keyword">import</span> android.widget.EditText;</span><br><span class="line"><span class="keyword">import</span> android.widget.TextView;</span><br><span class="line"><span class="keyword">import</span> androidx.activity.EdgeToEdge;</span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity;</span><br><span class="line"><span class="keyword">import</span> androidx.core.graphics.Insets;</span><br><span class="line"><span class="keyword">import</span> androidx.core.view.OnApplyWindowInsetsListener;</span><br><span class="line"><span class="keyword">import</span> androidx.core.view.ViewCompat;</span><br><span class="line"><span class="keyword">import</span> androidx.core.view.WindowInsetsCompat;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* loaded from: classes3.dex */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">AppCompatActivity</span> &#123;</span><br><span class="line">    <span class="comment">/* JADX INFO: Access modifiers changed from: protected */</span></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// androidx.fragment.app.FragmentActivity, androidx.activity.ComponentActivity, androidx.core.app.ComponentActivity, android.app.Activity</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        EdgeToEdge.enable(<span class="built_in">this</span>);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        ViewCompat.setOnApplyWindowInsetsListener(findViewById(R.id.main), <span class="keyword">new</span> <span class="title class_">OnApplyWindowInsetsListener</span>() &#123; <span class="comment">// from class: com.example.WarmUp.MainActivity$$ExternalSyntheticLambda0</span></span><br><span class="line">            <span class="meta">@Override</span> <span class="comment">// androidx.core.view.OnApplyWindowInsetsListener</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">final</span> WindowInsetsCompat <span class="title function_">onApplyWindowInsets</span><span class="params">(View view, WindowInsetsCompat windowInsetsCompat)</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> MainActivity.lambda$onCreate$<span class="number">0</span>(view, windowInsetsCompat);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">final</span> <span class="type">EditText</span> <span class="variable">flagInput</span> <span class="operator">=</span> (EditText) findViewById(R.id.flagInput);</span><br><span class="line">        <span class="type">Button</span> <span class="variable">confirmButton</span> <span class="operator">=</span> (Button) findViewById(R.id.confirmButton);</span><br><span class="line">        <span class="keyword">final</span> <span class="type">TextView</span> <span class="variable">validationResult</span> <span class="operator">=</span> (TextView) findViewById(R.id.validationResult);</span><br><span class="line">        confirmButton.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123; <span class="comment">// from class: com.example.WarmUp.MainActivity$$ExternalSyntheticLambda1</span></span><br><span class="line">            <span class="meta">@Override</span> <span class="comment">// android.view.View.OnClickListener</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View view)</span> &#123;</span><br><span class="line">                MainActivity.<span class="built_in">this</span>.m221lambda$onCreate$<span class="number">1</span>$comexampleWarmUpMainActivity(flagInput, validationResult, view);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* JADX INFO: Access modifiers changed from: package-private */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="comment">/* synthetic */</span> WindowInsetsCompat lambda$onCreate$<span class="number">0</span>(View v, WindowInsetsCompat insets) &#123;</span><br><span class="line">        <span class="type">Insets</span> <span class="variable">systemBars</span> <span class="operator">=</span> insets.getInsets(WindowInsetsCompat.Type.systemBars());</span><br><span class="line">        v.setPadding(systemBars.left, systemBars.top, systemBars.right, systemBars.bottom);</span><br><span class="line">        <span class="keyword">return</span> insets;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* JADX INFO: Access modifiers changed from: package-private */</span></span><br><span class="line">    <span class="comment">/* renamed from: lambda$onCreate$1$com-example-WarmUp-MainActivity  reason: not valid java name */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="comment">/* synthetic */</span> <span class="keyword">void</span> m221lambda$onCreate$<span class="number">1</span>$comexampleWarmUpMainActivity(EditText flagInput, TextView validationResult, View v) &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">inputFlag</span> <span class="operator">=</span> flagInput.getText().toString().trim();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (validateFlag(inputFlag)) &#123;</span><br><span class="line">                validationResult.setText(<span class="string">&quot;Correct!&quot;</span>);</span><br><span class="line">                validationResult.setTextColor(getResources().getColor(<span class="number">17170453</span>));</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                validationResult.setText(<span class="string">&quot;Wrong! Try Again!&quot;</span>);</span><br><span class="line">                validationResult.setTextColor(getResources().getColor(<span class="number">17170455</span>));</span><br><span class="line">            &#125;</span><br><span class="line">            validationResult.setVisibility(<span class="number">0</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">validateFlag</span><span class="params">(String data)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">RC4</span> <span class="variable">rc4</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RC4</span>();</span><br><span class="line">        <span class="type">String</span> <span class="variable">ciphertext</span> <span class="operator">=</span> rc4.encrypt(data, <span class="string">&quot;咪吗学高手&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> Base64.encodeToString(ciphertext.getBytes(), <span class="number">2</span>).equals(<span class="string">&quot;w5dDcHZ9woslI8KBPTNrYjlAwpzDjHgwI8OqeTrCpsOiwoZVCG/DjMOHwp3Dn3BPd8KtDwHDhMOUbQ==&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>题目不难，简单分析就知道是RC4魔改+base64了，</p>
<p>再看一下RC4</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.WarmUp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.bouncycastle.crypto.tls.CipherSuite;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* loaded from: classes3.dex */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RC4</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">encrypt</span><span class="params">(String plainOrCipherText, String key)</span> &#123;</span><br><span class="line">        Integer[] S = <span class="keyword">new</span> <span class="title class_">Integer</span>[<span class="number">256</span>];</span><br><span class="line">        Character[] keySchedul = <span class="keyword">new</span> <span class="title class_">Character</span>[plainOrCipherText.length()];</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">ciphertext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        ksa(S, key);</span><br><span class="line">        rpga(S, keySchedul, plainOrCipherText.length());</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; plainOrCipherText.length(); i++) &#123;</span><br><span class="line">            ciphertext.append((<span class="type">char</span>) (plainOrCipherText.charAt(i) ^ keySchedul[i].charValue()));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ciphertext.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">ksa</span><span class="params">(Integer[] s, String key)</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">256</span>; i++) &#123;</span><br><span class="line">            s[i] = Integer.valueOf(i ^ CipherSuite.TLS_RSA_PSK_WITH_AES_256_CBC_SHA);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i2</span> <span class="operator">=</span> <span class="number">0</span>; i2 &lt; <span class="number">256</span>; i2++) &#123;</span><br><span class="line">            j = ((s[i2].intValue() + j) + key.charAt(i2 % key.length())) % <span class="number">256</span>;</span><br><span class="line">            swap(s, i2, j);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">rpga</span><span class="params">(Integer[] s, Character[] keySchedul, <span class="type">int</span> plaintextLength)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">k</span> <span class="operator">=</span> <span class="number">0</span>; k &lt; plaintextLength; k++) &#123;</span><br><span class="line">            i = (i + <span class="number">1</span>) % <span class="number">256</span>;</span><br><span class="line">            j = (s[i].intValue() + j) % <span class="number">256</span>;</span><br><span class="line">            swap(s, i, j);</span><br><span class="line">            keySchedul[k] = Character.valueOf((<span class="type">char</span>) s[(s[i].intValue() + s[j].intValue()) % <span class="number">256</span>].intValue());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">swap</span><span class="params">(Integer[] s, <span class="type">int</span> i, <span class="type">int</span> j)</span> &#123;</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">mTemp</span> <span class="operator">=</span> s[i];</span><br><span class="line">        s[i] = s[j];</span><br><span class="line">        s[j] = mTemp;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>简单提及一下要用到的指令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">//控制台</span><br><span class="line"></span><br><span class="line">adb devices</span><br><span class="line"></span><br><span class="line">显示offline就</span><br><span class="line">adb reconnect offline</span><br><span class="line"></span><br><span class="line">adb shell</span><br><span class="line">su</span><br><span class="line">cd /data/local/tmp</span><br><span class="line">ls</span><br><span class="line">./fri......</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>frida的几种模式(彩蛋)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">先frida启动</span><br><span class="line">frida -U -f com.yyyiggod.cdmmmmmmm</span><br><span class="line"></span><br><span class="line">文件</span><br><span class="line">frida -U -f com.w3333333.sevedy -l .\jjkk.js</span><br><span class="line"></span><br><span class="line">先运行，再启动Frida,用文件名</span><br><span class="line">frida -U &#x27;showmaker&#x27; -l .\linkhash.js</span><br></pre></td></tr></table></figure>



<h2 id="法一：直接抄，然后解就行"><a href="#法一：直接抄，然后解就行" class="headerlink" title="法一：直接抄，然后解就行"></a>法一：直接抄，然后解就行</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RC4</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, key</span>):</span><br><span class="line">        <span class="variable language_">self</span>.S = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">        <span class="variable language_">self</span>.key = [<span class="built_in">ord</span>(char) <span class="keyword">for</span> char <span class="keyword">in</span> key]</span><br><span class="line">        <span class="variable language_">self</span>.ksa()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">ksa</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># Key Scheduling Algorithm (KSA)</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">            <span class="variable language_">self</span>.S[i] = i ^ <span class="number">149</span></span><br><span class="line"></span><br><span class="line">        j = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">            j = (j + <span class="variable language_">self</span>.S[i] + <span class="variable language_">self</span>.key[i % <span class="built_in">len</span>(<span class="variable language_">self</span>.key)]) % <span class="number">256</span></span><br><span class="line">            <span class="variable language_">self</span>.swap(<span class="variable language_">self</span>.S, i, j)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">rpga</span>(<span class="params">self, data</span>):</span><br><span class="line">        <span class="comment"># Pseudo-Random Generation Algorithm (PRGA)</span></span><br><span class="line">        i = j = <span class="number">0</span></span><br><span class="line">        keystream = []</span><br><span class="line">        <span class="keyword">for</span> char <span class="keyword">in</span> data:</span><br><span class="line">            i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">            j = (j + <span class="variable language_">self</span>.S[i]) % <span class="number">256</span></span><br><span class="line">            <span class="variable language_">self</span>.swap(<span class="variable language_">self</span>.S, i, j)</span><br><span class="line">            keystream.append(<span class="variable language_">self</span>.S[(<span class="variable language_">self</span>.S[i] + <span class="variable language_">self</span>.S[j]) % <span class="number">256</span>])</span><br><span class="line">        <span class="keyword">return</span> keystream</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">swap</span>(<span class="params">self, s, i, j</span>):</span><br><span class="line">        s[i], s[j] = s[j], s[i]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt_decrypt</span>(<span class="params">self, plain_or_cipher_text</span>):</span><br><span class="line">        <span class="comment"># Encrypt or decrypt the data using XOR operation</span></span><br><span class="line">        keystream = <span class="variable language_">self</span>.rpga(plain_or_cipher_text)</span><br><span class="line">        result = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(plain_or_cipher_text)):</span><br><span class="line">            result.append(<span class="built_in">chr</span>(<span class="built_in">ord</span>(plain_or_cipher_text[i]) ^ keystream[i]))</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(result)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="comment"># 示例: 使用 Base64 编码的密钥进行加解密</span></span><br><span class="line">    encoded_key = <span class="string">&quot;w5dDcHZ9woslI8KBPTNrYjlAwpzDjHgwI8OqeTrCpsOiwoZVCG/DjMOHwp3Dn3BPd8KtDwHDhMOUbQ==&quot;</span></span><br><span class="line">    plain_text = base64.b64decode(encoded_key).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    key = <span class="string">&quot;咪吗学高手&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 创建 RC4 加密解密实例</span></span><br><span class="line">    rc4 = RC4(key)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 加密过程</span></span><br><span class="line">    cipher_text = rc4.encrypt_decrypt(plain_text)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Cipher Text:&quot;</span>, cipher_text)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 解密过程</span></span><br><span class="line">    decrypted_text = rc4.encrypt_decrypt(cipher_text)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Decrypted Text:&quot;</span>, decrypted_text)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>感谢cdm格格送来的脚本</p>
<h2 id="法二：动态调试"><a href="#法二：动态调试" class="headerlink" title="法二：动态调试"></a>法二：动态调试</h2><p>因为rc4的加密特殊性我们采用输入 111111111111111111111111111111111来直接查看最后结果的方式反推</p>
<p>不过多赘述了，相同方法参见sctf sbox那题</p>
<p><img src="/2024/12/01/frida1/1.4.jpg" alt="1.4"></p>
<p>贴个脚本</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> flag[] = &#123; <span class="number">0xc2</span>,<span class="number">0x80</span>,<span class="number">0x1e</span>,<span class="number">0x20</span>,<span class="number">0x20</span>,<span class="number">0x37</span>,<span class="number">0xc3</span>,<span class="number">0x9b</span>,<span class="number">0x22</span>,<span class="number">0x23</span>,<span class="number">0xc2</span>,<span class="number">0x87</span>,<span class="number">0x3a</span>,<span class="number">0x30</span>,<span class="number">0x6e</span>,<span class="number">0x65</span>,<span class="number">0x25</span>,<span class="number">0x48</span>,<span class="number">0xc2</span>,<span class="number">0x9b</span>,<span class="number">0xc3</span>,<span class="number">0x8e</span>,<span class="number">0x2f</span>,<span class="number">0x2c</span>,<span class="number">0x26</span>,<span class="number">0xc2</span>,<span class="number">0xbd</span>,<span class="number">0x7c</span>,<span class="number">0x3c</span>,<span class="number">0xc2</span>,<span class="number">0xba</span>,<span class="number">0xc3</span>,<span class="number">0xaa</span>,<span class="number">0xc3</span>,<span class="number">0x93</span>,<span class="number">0x06</span>,<span class="number">0x00</span>,<span class="number">0x73</span>,<span class="number">0xc3</span>,<span class="number">0x85</span>,<span class="number">0xc3</span>,<span class="number">0x83</span>,<span class="number">0xc2</span>,<span class="number">0x9d</span>,<span class="number">0xc2</span>,<span class="number">0x88</span>,<span class="number">0x71</span>,<span class="number">0x48</span>,<span class="number">0x76</span>,<span class="number">0xc3</span>,<span class="number">0xbe</span>,<span class="number">0x0a</span>,<span class="number">0x06</span>,<span class="number">0xc2</span>,<span class="number">0x96</span>,<span class="number">0xc3</span>,<span class="number">0x95</span>,<span class="number">0x21</span> &#125;;</span><br><span class="line">    <span class="type">int</span> xxxor[] = &#123; <span class="number">0xc3</span>,<span class="number">0x97</span>,<span class="number">0x43</span>,<span class="number">0x70</span>,<span class="number">0x76</span>,<span class="number">0x7d</span>,<span class="number">0xc2</span>,<span class="number">0x8b</span>,<span class="number">0x25</span>,<span class="number">0x23</span>,<span class="number">0xc2</span>,<span class="number">0x81</span>,<span class="number">0x3d</span>,<span class="number">0x33</span>,<span class="number">0x6b</span>,<span class="number">0x62</span>,<span class="number">0x39</span>,<span class="number">0x40</span>,<span class="number">0xc2</span>,<span class="number">0x9c</span>,<span class="number">0xc3</span>,<span class="number">0x8c</span>,<span class="number">0x78</span>,<span class="number">0x30</span>,<span class="number">0x23</span>,<span class="number">0xc3</span>,<span class="number">0xaa</span>,<span class="number">0x79</span>,<span class="number">0x3a</span>,<span class="number">0xc2</span>,<span class="number">0xa6</span>,<span class="number">0xc3</span>,<span class="number">0xa2</span>,<span class="number">0xc2</span>,<span class="number">0x86</span>,<span class="number">0x55</span>,<span class="number">0x08</span>,<span class="number">0x6f</span>,<span class="number">0xc3</span>,<span class="number">0x8c</span>,<span class="number">0xc3</span>,<span class="number">0x87</span>,<span class="number">0xc2</span>,<span class="number">0x9d</span>,<span class="number">0xc3</span>,<span class="number">0x9f</span>,<span class="number">0x70</span>,<span class="number">0x4f</span>,<span class="number">0x77</span>,<span class="number">0xc2</span>,<span class="number">0xad</span>,<span class="number">0x0f</span>,<span class="number">0x01</span>,<span class="number">0xc3</span>,<span class="number">0x84</span>,<span class="number">0xc3</span>,<span class="number">0x94</span>,<span class="number">0x6d</span> &#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">58</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">char</span> a = flag[i] ^ xxxor[i] ^ <span class="number">0x31</span>;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, a);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//0&amp;lag&#123;0!61176246-91613f-40&amp;471-190$b9-1815110&amp;0600&quot;460#10&#125;</span></span><br></pre></td></tr></table></figure>

<p>没错，确实有问题，所以我们将使用第二种方法去取更精准的值</p>
<h2 id="法三-frida-hook取值"><a href="#法三-frida-hook取值" class="headerlink" title="法三: frida_hook取值"></a>法三: frida_hook取值</h2><p>我们要hook rc4加密后的返回结果</p>
<p><img src="/2024/12/01/frida1/1.4.png" alt="1.4"></p>
<p>这是很经典的一个hook模板了</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">function <span class="title function_">hook2</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">var</span> <span class="variable">MainActivity</span> <span class="operator">=</span> Java.use(<span class="string">&quot;com.example.WarmUp.RC4&quot;</span>);</span><br><span class="line">    MainActivity.encrypt.overload(<span class="string">&#x27;java.lang.String&#x27;</span>, <span class="string">&#x27;java.lang.String&#x27;</span>).implementation = function (a, b) &#123;</span><br><span class="line">        console.log(<span class="string">&quot;Origin i and i2 = &quot;</span>, a, b);</span><br><span class="line">        <span class="type">let</span> <span class="variable">result</span> <span class="operator">=</span> <span class="built_in">this</span>.encrypt(a, b);</span><br><span class="line">        console.log(<span class="string">&quot;Origin i and i2 = &quot;</span>, result);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.check(a, b);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    Java.perform(function () &#123;</span><br><span class="line">        hook2();</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">setImmediate(main);</span><br><span class="line"></span><br><span class="line"><span class="comment">//let RC4 = Java.use(&quot;com.example.WarmUp.RC4&quot;);</span></span><br></pre></td></tr></table></figure>



<p>结果</p>
<p><img src="/2024/12/01/frida1/1.5.jpg" alt="1.5"></p>
<p>那么，我们用java转16进制即可</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">function <span class="title function_">stringToByte</span><span class="params">(str)</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> ch, st, re = [];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">var</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; str.length; i++) &#123;</span><br><span class="line">        ch = str.charCodeAt(i);</span><br><span class="line">        st = [];</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            st.push(ch &amp; <span class="number">0xFF</span>);</span><br><span class="line">            ch = ch &gt;&gt; <span class="number">8</span>;</span><br><span class="line">        &#125; <span class="keyword">while</span> (ch);</span><br><span class="line">        re = re.concat(st.reverse());</span><br><span class="line">    &#125;   <span class="comment">// return an array of bytes  </span></span><br><span class="line">    <span class="keyword">return</span> re;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">function <span class="title function_">hook2</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">var</span> <span class="variable">MainActivity</span> <span class="operator">=</span> Java.use(<span class="string">&quot;com.example.WarmUp.RC4&quot;</span>);</span><br><span class="line">    MainActivity.encrypt.overload(<span class="string">&#x27;java.lang.String&#x27;</span>, <span class="string">&#x27;java.lang.String&#x27;</span>).implementation = function (a, b) &#123;</span><br><span class="line">        console.log(<span class="string">&quot;Origin i and i2 = &quot;</span>, a, b);</span><br><span class="line">        <span class="type">let</span> <span class="variable">result</span> <span class="operator">=</span> <span class="built_in">this</span>.encrypt(a, b);   <span class="comment">//打印加密的值</span></span><br><span class="line">        console.log(<span class="string">&quot;Origin i and i2 = &quot;</span>, result);</span><br><span class="line">        <span class="type">let</span> <span class="variable">byteResult</span> <span class="operator">=</span> stringToByte(result);</span><br><span class="line">        console.log(<span class="string">&quot;Result as byte array: &quot;</span>, byteResult);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 打印字节数组（如果需要）</span></span><br><span class="line">        <span class="comment">//console.log(&quot;Result as byte array: &quot;, byteResult);</span></span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    Java.perform(function () &#123;</span><br><span class="line">        hook2();</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">setImmediate(main);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>结果</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[Pixel 4::com.example.WarmUp ]-&gt; Origin i and i2 =  1111111111111111111111111111111 咪吗学高手</span><br><span class="line">Origin i and i2 =    7Û&quot;#:0ne%HÎ/,&amp;½|&lt;ºêÓ</span><br><span class="line">Result as byte array:  128,30,32,32,55,219,34,35,135,58,48,110,101,37,72,155,206,47,44,38,189,124,60,186,234,211,6</span><br></pre></td></tr></table></figure>

<p>没错，成功了，但是转念一想，既然输出多少有点问题，为什么不直接取值然后顺便就异或回去呢，只要脚本写在一起就行</p>
<p>先看一下怎么用他的导入包函数</p>
<p><img src="/2024/12/01/frida1/1.6.png" alt="1.6"></p>
<p><img src="/2024/12/01/frida1/1.7.png" alt="1.7"></p>
<p>脚本</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">setImmediate(function () &#123;</span><br><span class="line">    Java.perform(function () &#123;</span><br><span class="line">        <span class="comment">// 获取 RC4 类的引用</span></span><br><span class="line">        <span class="type">var</span> <span class="variable">RC4</span> <span class="operator">=</span> Java.use(<span class="string">&#x27;com.example.WarmUp.RC4&#x27;</span>);</span><br><span class="line">        <span class="keyword">var</span> keyIndeed</span><br><span class="line">        <span class="comment">// hook encrypt 方法</span></span><br><span class="line">        RC4.encrypt.implementation = function (plainOrCipherText, key) &#123;</span><br><span class="line">            console.log(<span class="string">&#x27;Calling RC4.encrypt with plainOrCipherText: &#x27;</span> + plainOrCipherText + <span class="string">&#x27;, key: &#x27;</span> + key);</span><br><span class="line">            keyIndeed = key</span><br><span class="line"></span><br><span class="line">            <span class="type">var</span> <span class="variable">base64CipherText</span> <span class="operator">=</span> <span class="string">&quot;w5dDcHZ9woslI8KBPTNrYjlAwpzDjHgwI8OqeTrCpsOiwoZVCG/DjMOHwp3Dn3BPd8KtDwHDhMOUbQ==&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="type">var</span> <span class="variable">decodedCipherText</span> <span class="operator">=</span> Java.use(<span class="string">&#x27;android.util.Base64&#x27;</span>).decode(base64CipherText, <span class="number">2</span>); <span class="comment">// 2表示URL-safe模式</span></span><br><span class="line"></span><br><span class="line">            <span class="type">var</span> <span class="variable">decodedText</span> <span class="operator">=</span> Java.use(<span class="string">&#x27;java.lang.String&#x27;</span>).$<span class="keyword">new</span>(decodedCipherText);</span><br><span class="line"></span><br><span class="line">            <span class="type">var</span> <span class="variable">result</span> <span class="operator">=</span> <span class="built_in">this</span>.encrypt(decodedText, key);</span><br><span class="line"></span><br><span class="line">            console.log(<span class="string">&#x27;RC4.encrypt result: &#x27;</span> + result);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 返回加密结果</span></span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>



<p><img src="/2024/12/01/frida1/1.8.png" alt="1.8"></p>
<p>也确实成功了</p>
<h2 id="法四：暴力内存搜刮"><a href="#法四：暴力内存搜刮" class="headerlink" title="法四：暴力内存搜刮"></a>法四：暴力内存搜刮</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.52pojie.cn/thread-1838539-1-1.html</span><br></pre></td></tr></table></figure>

<p>有点复杂，具体去看正己师傅的文章</p>
<p>主要是要换frida环境</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">pip install virtualenvwrapper-win -i https://pypi.tuna.tsinghua.edu.cn/simple</span><br><span class="line">mkvirtualenv frida14</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">(frida14)pip install frida-tools==9.2.4</span><br><span class="line">//虽然我没搞就是了，报错再说.....</span><br></pre></td></tr></table></figure>

<p>命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">objection -g com.example.saga131 explore</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">android hooking list activities -查看内存中加载的activity   /android hooking list services -查看内存中加载的services</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">android intent launch_activity 类名 -启动activity或service(可以用于一些没有验证的activity,在一些简单的ctf中有时候可以出奇效)</span><br><span class="line"></span><br><span class="line">//这个程序比较简单，如果复杂的话可以使用类的搜索</span><br><span class="line">android hooking search classes +</span><br><span class="line">//android hooking search classes example</span><br></pre></td></tr></table></figure>



<p>首先我们需要一个hashcode</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">com.example.WarmUp on (google: 10) [usb] # android heap search instances com.example.WarmUp.MainActivity</span><br><span class="line">Class instance enumeration complete for com.example.WarmUp.MainActivity</span><br><span class="line">Hashcode  Class                            toString()</span><br><span class="line">--------  -------------------------------  ---------------------------------------</span><br><span class="line">22710814  com.example.WarmUp.MainActivity  com.example.WarmUp.MainActivity@15a8a1e</span><br><span class="line">11745467  com.example.WarmUp.MainActivity  com.example.WarmUp.MainActivity@b338bb</span><br></pre></td></tr></table></figure>

<p><img src="/2024/12/01/frida1/1.9.png" alt="1.9"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">android heap execute &lt;handle&gt; getPublicInt(实例的hashcode+方法名)   //这里要求无参数，待会再找个无参数demo实验</span><br><span class="line"></span><br><span class="line">如果是带参数的方法，则需要进入编辑器环境  </span><br><span class="line">android heap evaluate &lt;handle&gt;  </span><br><span class="line">console.log(clazz.a(&quot;吾爱破解&quot;));</span><br><span class="line"></span><br><span class="line">//console.log(clazz.validateFlag(&quot;11111111111111111111&quot;))</span><br><span class="line">按住esc+enter触发</span><br></pre></td></tr></table></figure>

<p><img src="/2024/12/01/frida1/2.0.png" alt="2.0"></p>
<p><img src="/2024/12/01/frida1/2.1.png" alt="2.1"></p>
<p>当然，还能用方法</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">android hooking list class_methods com.example.WarmUp.MainActivity 类名 -内存漫游类中的所有方法</span><br></pre></td></tr></table></figure>

<p><img src="/2024/12/01/frida1/2.2.png" alt="2.2"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">android hooking watch class_method 类名.方法名 --dump-args --dump-return --dump-backtrace</span><br><span class="line">//android hooking watch class_method com.example.WarmUp.MainActivity.validateF</span><br><span class="line">lag --dump-args --dump-return --dump-backtrace</span><br></pre></td></tr></table></figure>

<p><img src="/frida1/2.3.png" alt="2.3"></p>
<h3 id="开始正题"><a href="#开始正题" class="headerlink" title="开始正题"></a>开始正题</h3><p>所实话，感觉有点像java层模拟执行</p>
<p>有个问题，就是你会发现他搜不到这个RC4类，可以给大家看一下我之前的内存寻找结果</p>
<p><img src="/2024/12/01/frida1/2.5.png" alt="2.5"></p>
<p>所以，我们得多点几下check,让他抓到，再人为搜索</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">com.example.WarmUp on (google: 10) [usb] # android hooking search classes RC4</span><br><span class="line">Note that Java classes are only loaded when they are used, so if the expected class has not been found, it might not have been loaded yet.</span><br><span class="line">com.android.org.bouncycastle.jcajce.provider.symmetric.ARC4</span><br><span class="line">com.android.org.bouncycastle.jcajce.provider.symmetric.ARC4$Mappings</span><br><span class="line">com.example.WarmUp.RC4</span><br></pre></td></tr></table></figure>





<p>找个hashcode先</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">com.example.WarmUp on (google: 10) [usb] # android heap search instances com.example.WarmUp.RC4</span><br><span class="line">Class instance enumeration complete for com.example.WarmUp.RC4</span><br><span class="line"> Hashcode  Class                   toString()</span><br><span class="line">---------  ----------------------  ------------------------------</span><br><span class="line">108025448  com.example.WarmUp.RC4  com.example.WarmUp.RC4@6705668</span><br></pre></td></tr></table></figure>



<p><img src="/2024/12/01/frida1/2.4.png" alt="2.4"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">com.example.WarmUp on (google: 10) [usb] # android heap evaluate 108025448</span><br><span class="line">(The hashcode at `108025448` will be available as the `clazz` variable.)</span><br><span class="line">console.log(clazz.encrypt(&quot;11111111111111111111111111111111111&quot;, &quot;咪吗学高手&quot;))</span><br><span class="line">JavaScript capture complete. Evaluating...</span><br><span class="line">Handle 108025448 is to class</span><br><span class="line">        com.example.WarmUp.RC4</span><br><span class="line">  7Û&quot;#:0ne%HÎ/,&amp;½|&lt;ºêÓ</span><br></pre></td></tr></table></figure>

<p>额，没区别啊，…….,感觉得想个办法，最好使用16进制的格式输出</p>
<p>不过找到了objection其他好玩的功能</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.anquanke.com/post/id/197657</span><br></pre></td></tr></table></figure>

<p>有个辅助写frida的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">android hooking generate simple com.example.WarmUp.RC4</span><br></pre></td></tr></table></figure>

<p>效果</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">Java.perform(function() &#123;</span><br><span class="line">    <span class="type">var</span> <span class="variable">clazz</span> <span class="operator">=</span> Java.use(<span class="string">&#x27;com.example.WarmUp.RC4&#x27;</span>);</span><br><span class="line">    clazz.swap.implementation = function() &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> clazz.swap.apply(<span class="built_in">this</span>, arguments);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Java.perform(function() &#123;</span><br><span class="line">    <span class="type">var</span> <span class="variable">clazz</span> <span class="operator">=</span> Java.use(<span class="string">&#x27;com.example.WarmUp.RC4&#x27;</span>);</span><br><span class="line">    clazz.rpga.implementation = function() &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> clazz.rpga.apply(<span class="built_in">this</span>, arguments);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Java.perform(function() &#123;</span><br><span class="line">    <span class="type">var</span> <span class="variable">clazz</span> <span class="operator">=</span> Java.use(<span class="string">&#x27;com.example.WarmUp.RC4&#x27;</span>);</span><br><span class="line">    clazz.ksa.implementation = function() &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> clazz.ksa.apply(<span class="built_in">this</span>, arguments);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Java.perform(function() &#123;</span><br><span class="line">    <span class="type">var</span> <span class="variable">clazz</span> <span class="operator">=</span> Java.use(<span class="string">&#x27;com.example.WarmUp.RC4&#x27;</span>);</span><br><span class="line">    clazz.encrypt.implementation = function() &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> clazz.encrypt.apply(<span class="built_in">this</span>, arguments);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//还行，自己在修改一下</span></span><br></pre></td></tr></table></figure>



<h1 id="必要的知识掌握"><a href="#必要的知识掌握" class="headerlink" title="必要的知识掌握"></a>必要的知识掌握</h1><p>有个超级好看的文章，建议都去学一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.52pojie.cn/thread-742686-1-1.html</span><br></pre></td></tr></table></figure>

<p>先加个debuggable再找一下入口函数</p>
<p><img src="/2024/12/01/frida1/1.3.png" alt="1.3"></p>
<h1 id="小插件"><a href="#小插件" class="headerlink" title="小插件"></a>小插件</h1><p>可以帮助分析so层的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/Pr0214/trace_natives</span><br></pre></td></tr></table></figure>

<p>大家真可以去下下这个，好有意思的小.py文件</p>
<h1 id="frida检测绕过"><a href="#frida检测绕过" class="headerlink" title="frida检测绕过"></a>frida检测绕过</h1><p><a target="_blank" rel="noopener" href="https://github.com/Ylarod/Florida">GitHub - Ylarod&#x2F;Florida: 基础反检测 frida-server &#x2F; Basic anti-detection frida-server</a></p>
<p>download</p>
<p><img src="/2024/12/01/frida1/1.1.png" alt="1.1"></p>
<p>下载16.5.6这个</p>
<p><img src="/2024/12/01/frida1/1.2.png" alt="1.2"></p>
<p>然后用法和frida一样</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frida -U -f com.jjkk.showmaker</span><br></pre></td></tr></table></figure>





</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="http://example.com">jjkk</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="http://example.com/2024/12/01/frida1/">http://example.com/2024/12/01/frida1/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/frida/">frida</a></div><div class="post-share"><div class="social-share" data-image="/img/jjkk.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related full-width" href="/2024/11/10/hello-world/" title="Hello World"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">Hello World</div></div><div class="info-2"><div class="info-item-1">Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new &quot;My New Post&quot;  More info: Writing Run server1$ hexo server  More info: Server Generate static files1$ hexo generate  More info: Generating Deploy to remote sites1$ hexo deploy  More info: Deployment </div></div></div></a></nav><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comments</span></div><div class="comment-switch"><span class="first-comment">Valine</span><span id="switch-btn"></span><span class="second-comment">Gitalk</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/jjkk.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">jjkk</div><div class="author-info-description">争取每日少水群10分钟来更新blog</div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">2</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">1</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://jjkk.github.io" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:xxxxxx@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%95%E4%B8%80%EF%BC%9A%E7%9B%B4%E6%8E%A5%E6%8A%84%EF%BC%8C%E7%84%B6%E5%90%8E%E8%A7%A3%E5%B0%B1%E8%A1%8C"><span class="toc-number">1.</span> <span class="toc-text">法一：直接抄，然后解就行</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%95%E4%BA%8C%EF%BC%9A%E5%8A%A8%E6%80%81%E8%B0%83%E8%AF%95"><span class="toc-number">2.</span> <span class="toc-text">法二：动态调试</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%95%E4%B8%89-frida-hook%E5%8F%96%E5%80%BC"><span class="toc-number">3.</span> <span class="toc-text">法三: frida_hook取值</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%95%E5%9B%9B%EF%BC%9A%E6%9A%B4%E5%8A%9B%E5%86%85%E5%AD%98%E6%90%9C%E5%88%AE"><span class="toc-number">4.</span> <span class="toc-text">法四：暴力内存搜刮</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%80%E5%A7%8B%E6%AD%A3%E9%A2%98"><span class="toc-number">4.1.</span> <span class="toc-text">开始正题</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BF%85%E8%A6%81%E7%9A%84%E7%9F%A5%E8%AF%86%E6%8E%8C%E6%8F%A1"><span class="toc-number"></span> <span class="toc-text">必要的知识掌握</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B0%8F%E6%8F%92%E4%BB%B6"><span class="toc-number"></span> <span class="toc-text">小插件</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#frida%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87"><span class="toc-number"></span> <span class="toc-text">frida检测绕过</span></a></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/12/01/frida1/" title="frida小总结（1）">frida小总结（1）</a><time datetime="2024-12-01T12:05:35.000Z" title="Created 2024-12-01 20:05:35">2024-12-01</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/11/10/hello-world/" title="Hello World">Hello World</a><time datetime="2024-11-10T08:16:04.506Z" title="Created 2024-11-10 16:16:04">2024-11-10</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2024 By jjkk</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="Scroll to Comments"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.isShuoshuo
  const option = null

  const initValine = (el, path) => {
    if (isShuoshuo) {
      window.shuoshuoComment.destroyValine = () => {
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }

    const valineConfig = {
      el: '#vcomment',
      appId: '',
      appKey: '',
      avatar: 'monsterid',
      serverURLs: '',
      emojiMaps: "",
      visitor: false,
      ...option,
      path: isShuoshuo ? path : (option && option.path) || window.location.pathname
    }

    new Valine(valineConfig)
  }

  const loadValine = async (el, path) => {
    if (typeof Valine === 'function') {
      initValine(el, path)
    } else {
      await btf.getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js')
      initValine(el, path)
    }
  }

  if (isShuoshuo) {
    'Valine' === 'Valine'
      ? window.shuoshuoComment = { loadComment: loadValine }
      : window.loadOtherComment = loadValine
    return
  }

  if ('Valine' === 'Valine' || !true) {
    if (true) btf.loadComment(document.getElementById('vcomment'),loadValine)
    else setTimeout(loadValine, 0)
  } else {
    window.loadOtherComment = loadValine
  }
})()</script><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.isShuoshuo
  const option = null

  const commentCount = n => {
    const isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
    if (isCommentCount) {
      isCommentCount.textContent= n
    }
  }

  const initGitalk = (el, path) => {
    if (isShuoshuo) {
      window.shuoshuoComment.destroyGitalk = () => {
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }

    const gitalk = new Gitalk({
      clientID: '',
      clientSecret: '',
      repo: '',
      owner: '',
      admin: [''],
      updateCountCallback: commentCount,
      ...option,
      id: isShuoshuo ? path : (option && option.id) || 'b288b68d31a8902e0b94d5bab27c94c9'
    })

    gitalk.render('gitalk-container')
  }

  const loadGitalk = async(el, path) => {
    if (typeof Gitalk === 'function') initGitalk(el, path)
    else {
      await btf.getCSS('https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css')
      await btf.getScript('https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.js')
      initGitalk(el, path)
    }
  }

  if (isShuoshuo) {
    'Valine' === 'Gitalk'
      ? window.shuoshuoComment = { loadComment: loadGitalk }
      : window.loadOtherComment = loadGitalk
    return
  }

  if ('Valine' === 'Gitalk' || !true) {
    if (true) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
    else loadGitalk()
  } else {
    window.loadOtherComment = loadGitalk
  }
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>